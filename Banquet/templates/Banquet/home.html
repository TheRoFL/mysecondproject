{% extends 'index.html' %}

<!-- prettier-ignore -->
{% block content %} {% load static %}
<h1>Формирование банкета</h1>
<head>
  <script>
    var username_id_added = "{{user.id}}";
    var current_client_id_added = "{{current_client.id}}";
    var current_client_name = "{{current_client.type}}";
    localStorage.setItem("username_id", username_id_added);
    localStorage.setItem("current_client_id", current_client_id_added);
    localStorage.setItem("dishFilter", current_client_id_added);
    localStorage.setItem("current_client_name", current_client_name);
    var username_id = localStorage.getItem("username_id");
    var current_client_id = localStorage.getItem("current_client_id");
  </script>
  <link rel="stylesheet" href="/static/styles/menu-grid.css" />
  <link rel="stylesheet" href="/static/styles/banquet.css" />
</head>
<body>
  <div class="body">
    <form id="clientForm" style="margin-left: 10px">
      <label for="clientName">Название клиента:</label>
      <input type="text" id="clientName" required />

      <label for="clientCount">Количество клиентов:</label>
      <input type="number" id="clientCount" required />
      <br />

      <button type="submit">Сохранить</button>
      <button type="button" id="cancelFormBtn">Отменить</button>
    </form>
    <div class="vseClients">
      <!-- prettier-ignore -->
      <div class="all_clients">
        {% for client in banquet.clients.all %}
        <div class="client-header">
          <div class="client-info">
            <h1 class="client-info-h1" data-id="{{client.id}}">
              Меню для клиента типа "<span
                class="client-name"
                data-id="{{client.id}}"
                >{{client.type}}</span
              >" в количестве
              <span class="client-quantity" data-id="{{client.id}}"
                >{{client.quantity}}</span
              >
              человек
            </h1>
          </div>
          <div
            class="client-container-{{client.id}}"
            id="client-container-{{client.id}}"
          >
            <!-- prettier-ignore -->
            {% if client.menu %}

            <div class="client-menu" data-id="{{client.id}}-{{client.menu.id}}">
              <div class="client-menu-btn">
                <h1 style="display: inline-block">{{client.menu}}</h1>
                <button
                  class="delete-menu-btn"
                  data-id="{{client.menu.id}}"
                  data-clientId="{{client.id}}"
                  style="margin-top: 0px"
                >
                  Удалить
                </button>
              </div>
              {% for dish in client.menu.dishes.all %}
              <div class="client-menu-dish" data-id="{{dish.id}}">
                <h1 style="margin-left: 25px">
                  -{{dish.product.name}} x {{dish.quantity}} шт. =
                  {{dish.price_count}}.00 руб.
                </h1>
              </div>
              {% endfor %}
              <h1 style="margin-left: 15px">
                Итого:
                <span class="menu-total" data-id="{{client.menu.id}}"
                  >{{client.menu.all_dishes_price}}</span
                >.00 руб. с человека
              </h1>
              <h1>--------------------------------------------------------</h1>
            </div>

            {%endif%}

            <!-- prettier-ignore -->
            {% comment %} {% else %} {% endcomment %}
            {% for client_dishOrder in client.dishes.all %}
            <div>
              <div
                class="client-orders-{{client_dishOrder.id}}"
                id="client-orders-{{client_dishOrder.id}}"
              >
                <h1>
                  <div
                    class="client_dishOrder-element"
                    data-id="{{client_dishOrder.id}}"
                  >
                    <!-- prettier-ignore -->
                    <h2 style="margin-left: 30px">
                    {{client_dishOrder.product.name}} x 
                    <span
                      class="client_order_quantity"
                      data-id="{{client.id}}"
                      id="{{client_dishOrder.id}}"
                      >{{client_dishOrder.quantity}} 
                    </span> шт. =
                   
                    <span
                      class="client_order_price"
                      data-id="{{client.id}}"
                      id="{{client_dishOrder.id}}"
                      >{{client_dishOrder.price_count}}</span
                    >.00 руб.
                  </h2>
                  </div>
                  <button
                    class="delete-btn"
                    data-id="{{client_dishOrder.id}}"
                    data-clientId="{{client.id}}"
                  >
                    X
                  </button>
                </h1>
              </div>
            </div>
            <!-- prettier-ignore -->
            {% endfor %}
          </div>

          <h2
            class="client-total-price"
            style="margin-top: 50px; margin-left: 20px"
          >
            <!-- prettier-ignore -->
            {% if client.menu %} 
            Итого за всех клиентов:
            <span
              class="order-price-count"
              data-id="{{client.id}}"
              id="{{client.id}}"
            >
              {{client.total_client_price}}</span
            >.00 руб. x
            <span class="client-quantity-2" data-id="{{client.id}}"
              >{{client.quantity}}</span
            >
            человек =
            <span
              class="client-price-count"
              data-id="{{client.id}}"
              id="{{client.id}}"
              >{{client.menu_and_orders_price_count}}</span
            >.00 руб.
            <!-- prettier-ignore -->
            {%else %} Итого за всех клиентов:
            <span
              class="order-price-count"
              data-id="{{client.id}}"
              id="{{client.id}}"
            >
              {{client.price_count}}</span
            >.00 руб. x
            <span class="client-quantity-2" data-id="{{client.id}}"
              >{{client.quantity}}</span
            >
            человек =
            <span
              class="client-price-count"
              data-id="{{client.id}}"
              id="{{client.id}}"
              >{{client.menu_and_orders_price_count}}</span
            >.00 руб. {%endif%}
          </h2>
        </div>

        <h1>&nbsp</h1>

        {% endfor %}
      </div>
      {% if banquet.clients.all %} {% for client in banquet.clients.all %}
      <div class="my_client formaClienta" data-id="{{client.id}}">
        <div class="formaClienta_header">
          <input
            class="name-input"
            data-id="{{client.id}}"
            value="{{ client.type }}"
          />
          <p
            style="
              font-size: 10px;
              display: inline;
              color: #fff;
              margin-bottom: 12px;
            "
          >
            x
          </p>
          <input
            class="quantity-input"
            data-id="{{client.id}}"
            value="{{ client.quantity }}"
          />

          <button class="delete-client-btn">
            <img
              data-id="{{client.id}}"
              class="musorka"
              src="/static/images/Мусорка.png"
              alt="delete"
            />
          </button>
        </div>

        <button class="menu-client-btn" data-id="{{client.id}}">
          Выбрать для редактирования
        </button>
        <h1 style="margin-left: 15px">
          Итого:
          <span class="menu-total" data-id="{{client.menu.id}}"
            >{{client.menu.all_dishes_price}}</span
          >.00 руб. с человека
        </h1>
      </div>

      {% endfor %} {% endif %}
      <button id="showFormBtn" class="formaClienta">+</button>
    </div>

    {% if current_client %}
    <h1>
      Режим редактирования меню "<span
        class="client-name-3"
        data-id="{{client.id}}"
        >{{current_client.type}}</span
      >"
    </h1>
    {% else %}
    <h1>Выберите меню для редактирования</h1>
    {% endif %}
    <style>
      .dish-filter {
        text-decoration: none;
      }

      .active {
        text-decoration: underline;
      }
    </style>
    <style>
      .highlighted {
        background-color: yellow; /* Измените на цвет подсветки по вашему выбору */
        color: black; /* Измените на цвет текста по вашему выбору */
        /* Другие стили по вашему усмотрению */
      }
    </style>

    <button class="dish-filter" data-filter="samples" id="requestButton">
      Готовые меню
    </button>
    <button class="dish-filter" data-filter="all" id="requestButton">
      Все блюда
    </button>
    <button class="dish-filter" data-filter="salads" id="requestButton">
      Салаты
    </button>
    <button class="dish-filter" data-filter="hot_dishes" id="requestButton">
      Горячие блюда
    </button>
    <button class="dish-filter" data-filter="drinks" id="requestButton">
      Напитки
    </button>
    <button class="dish-filter" data-filter="desserts" id="requestButton">
      Десерты
    </button>
    <a
      class="dish-filter"
      href="/banquet/?dish-filter=samples&editting-clientId={{clientId}}"
      >Готовые меню</a
    >
    {% if dish_type != 'samples' %}
    <div class="grid-container">
      {% for current_dish in current_dishes %}
      <div class="grid-item">
        <div
          class="dishes"
          data-name="{{current_dish.create_tittle}}"
          data-tittle="{{current_dish.name}}"
          data-weight="{{current_dish.weight}}"
          data-price="{{current_dish.price}}"
          data-sostav="{{current_dish.ingredients}}"
          data-type="{{current_dish.type}}"
        >
          <img
            src="http://localhost:8000/media/menu_images/{{current_dish.type}}/{{current_dish.name}}.png"
          />
          <h3>
            {{current_dish.tittle}} / {{current_dish.weight}} гр. /
            {{current_dish.price}} руб.
          </h3>
        </div>
        <h2>
          <button
            class="order-button"
            data-id="{{current_dish.id}}"
            data-name="{{current_dish.tittle}}"
          >
            {% if current_client %} Добавить для "<span
              class="client-name-2"
              data-id="{{client.id}}"
              >{{current_client.type}}</span
            >" {%else%} Выберите клиента {% endif %}
          </button>
        </h2>
      </div>

      {% endfor %}
    </div>

    {% else %}
    <!-- prettier-ignore -->
    <div class="grid-container">
      {% for menu_sample in current_dishes %}

      <h1>{{menu_sample}} текст чтобы  </h1>
      <h2>
        <button
          class="order-button"
          data-id="{{menu_sample.id}}"
          data-name="{{menu_sample.type}}"
        >
          {% if current_client %} Добавить для "<span
            class="client-name-2"
            data-id="{{client.id}}"
            >{{current_client.type}}</span
          >" {%else%} Выберите клиента {% endif %}
        </button>
      </h2>
       {% for dish in menu_sample.dishes.all %}
        <div class="grid-item dishes"    
          data-tittle="{{dish.product.create_tittle2}}"
          data-name="{{dish.product.name}}"
          data-weight="{{dish.product.weight}}"
          data-price="{{dish.product.price}}"
          data-sostav="{{dish.product.ingredients}}"
          data-type="{{dish.product.type}}"
        >
          <img
            src="http://localhost:8000/media/menu_images/{{dish.product.type}}/{{dish.product.create_tittle2}}.png"
        />
          <h3>{{dish.product.name}} / {{dish.product.weight}} гр. / {{dish.product.price}} руб.</h3>
        </div>
      {% endfor %}
      <h1>--------------------------------------------------------------------------------</h1>
      
      {% endfor %}
    </div>

    {% endif %}

    <h1>&nbsp</h1>
    <hr style="width: 90%; height: 3px; background: #e74c3c" />
    <h1>&nbsp</h1>
    <style>
      .delete-btn {
        position: absolute;
        /* Укажите здесь нужные значения для top, left, right или bottom */
      }
      .client_dishOrder-element {
        display: inline-block;
      }
    </style>
    <!-- prettier-ignore -->
    <div class="all_clients">
      {% for client in banquet.clients.all %}
<<<<<<< HEAD
      <div class="client-header">
=======
      <div class="client-header" data-id="{{client.id}}">
>>>>>>> 704a553aabaaf102ec881d6be713b8d3807cd2b0
        <div class="client-info">
          <h1 class="client-info-h1" data-id="{{client.id}}">
            Меню для клиента типа "<span
              class="client-name"
              data-id="{{client.id}}"
              >{{client.type}}</span
            >" в количестве
            <span class="client-quantity" data-id="{{client.id}}"
              >{{client.quantity}}</span
            >
            человек
          </h1>
        </div>
        <div
          class="client-container-{{client.id}}"
          id="client-container-{{client.id}}"
        >
          <!-- prettier-ignore -->
          {% if client.menu %}
<<<<<<< HEAD
  
=======

>>>>>>> 704a553aabaaf102ec881d6be713b8d3807cd2b0
          <div class="client-menu" data-id="{{client.id}}-{{client.menu.id}}">
            <div class="client-menu-btn">
              <h1 style="display: inline-block">{{client.menu}}</h1>
              <button
                class="delete-menu-btn"
                data-id="{{client.menu.id}}"
                data-clientId="{{client.id}}"
                style="margin-top: 0px"
              >
                Удалить
              </button>
            </div>
            {% for dish in client.menu.dishes.all %}
            <div class="client-menu-dish" data-id="{{dish.id}}">
              <h1 style="margin-left: 25px">
                -{{dish.product.name}} x {{dish.quantity}} шт. =
                {{dish.price_count}}.00 руб.
              </h1>
            </div>
            {% endfor %}
            <h1 style="margin-left: 15px">
              Итого:
              <span class="menu-total" data-id="{{client.menu.id}}"
                >{{client.menu.all_dishes_price}}</span
              >.00 руб. с человека
            </h1>
            <h1>--------------------------------------------------------</h1>
          </div>
<<<<<<< HEAD
  
          {%endif%}
  
=======

          {%endif%}

>>>>>>> 704a553aabaaf102ec881d6be713b8d3807cd2b0
          <!-- prettier-ignore -->
          {% comment %} {% else %} {% endcomment %}
          {% for client_dishOrder in client.dishes.all %}
          <div>
            <div
              class="client-orders-{{client_dishOrder.id}}"
              id="client-orders-{{client_dishOrder.id}}"
            >
              <h1>
                <div
                  class="client_dishOrder-element"
                  data-id="{{client_dishOrder.id}}"
                >
                  <!-- prettier-ignore -->
                  <h2 style="margin-left: 30px">
                  {{client_dishOrder.product.name}} x 
                  <span
                    class="client_order_quantity"
                    data-id="{{client.id}}"
                    id="{{client_dishOrder.id}}"
                    >{{client_dishOrder.quantity}} 
                  </span> шт. =
<<<<<<< HEAD
                 
=======
                
>>>>>>> 704a553aabaaf102ec881d6be713b8d3807cd2b0
                  <span
                    class="client_order_price"
                    data-id="{{client.id}}"
                    id="{{client_dishOrder.id}}"
                    >{{client_dishOrder.price_count}}</span
                  >.00 руб.
                </h2>
                </div>
                <button
                  class="delete-btn"
                  data-id="{{client_dishOrder.id}}"
                  data-clientId="{{client.id}}"
                >
                  X
                </button>
              </h1>
            </div>
          </div>
          <!-- prettier-ignore -->
          {% endfor %}
        </div>
<<<<<<< HEAD
  
=======

>>>>>>> 704a553aabaaf102ec881d6be713b8d3807cd2b0
        <h2
          class="client-total-price"
          style="margin-top: 50px; margin-left: 20px"
        >
          <!-- prettier-ignore -->
          {% if client.menu %} 
          Итого за всех клиентов:
          <span
            class="order-price-count"
            data-id="{{client.id}}"
            id="{{client.id}}"
          >
            {{client.total_client_price}}</span
          >.00 руб. x
          <span class="client-quantity-2" data-id="{{client.id}}"
            >{{client.quantity}}</span
          >
          человек =
          <span
            class="client-price-count"
            data-id="{{client.id}}"
            id="{{client.id}}"
            >{{client.menu_and_orders_price_count}}</span
          >.00 руб.
          <!-- prettier-ignore -->
          {%else %} Итого за всех клиентов:
          <span
            class="order-price-count"
            data-id="{{client.id}}"
            id="{{client.id}}"
          >
            {{client.price_count}}</span
          >.00 руб. x
          <span class="client-quantity-2" data-id="{{client.id}}"
            >{{client.quantity}}</span
          >
          человек =
          <span
            class="client-price-count"
            data-id="{{client.id}}"
            id="{{client.id}}"
            >{{client.menu_and_orders_price_count}}</span
          >.00 руб. {%endif%}
        </h2>
<<<<<<< HEAD
      </div>
  
      <h1>&nbsp</h1>
  
      {% endfor %}
      </div>
=======
      </div>

      <h1>&nbsp</h1>

      {% endfor %}
    </div>
>>>>>>> 704a553aabaaf102ec881d6be713b8d3807cd2b0
    <h1>
      Сумма заказа:
      <span class="banquet-total-price" data-id="{{banquet.id}}"
        >{{banquet.total_price}}.00 руб.
      </span>
      <button><a href="/banquet/ordering/">Оформить заказ</a></button>
    </h1>
  </div>

  <h1>&nbsp</h1>
  <hr style="width: 90%; height: 3px; background: #e74c3c" />
  <h1>&nbsp</h1>

  {% for menu_sample in menu_samples %} {{menu_sample}} {% endfor %}

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="/static/js/banquet_changing.js"></script>
  <script src="/static/js/banquet_edit_links.js"></script>

  <script src="/static/js/banquet_filters.js"></script>
</body>
{% endblock content %}
